df2$residual = resid(fit3)
q1 = ggplot(df2, aes(sample = residual, colour = sex)) +
stat_qq() +
stat_qq_line()
q2 = ggplot(data = df2, aes(x = sex, y= residual, colour = sex))+ geom_boxplot() + geom_jitter(width = 0.3)
q3 = ggplot(data = df2, aes(x = tIn, y= residual, col = sex))+ geom_point()  + xlab('Indoor operating temperature (tInOp)')
q4 = ggplot(data = df2, aes(x = tOut, y= residual, col = sex))+ geom_point() + xlab('Outdoor temperature (tOut)')
grid.arrange(q1,q2)
resid(fit)
resid(fit[df2$sex == 'female])
resid(fit[df2$sex == 'female'])
resid(fit[df2$sex == 'female'])
resid(fit[df2$sex == 'male'])/resid(fit[df2$sex == 'female'])
resid(fit[df2$sex == 'males'])/resid(fit[df2$sex == 'female'])
resid(fit[df2$sex == 'males'])/resid(fit[df2$sex == 'females'])
df2$sex
resid(fit[df2$sex == 'male'])/resid(fit[df2$sex == 'female'])
resid(fit[df2$sex == 'male'])#/resid(fit[df2$sex == 'female'])
df2$sex == 'male']
df2$sex == 'male'
resid(fit)[df2$sex == 'male']#/resid(fit[df2$sex == 'female'])
resid(fit)[df2$sex == 'male']/resid(fit)[df2$sex == 'female']
sd(resid(fit)[df2$sex == 'male'])/sd(resid(fit)[df2$sex == 'female'])
var(resid(fit)[df2$sex == 'male'])/var(resid(fit)[df2$sex == 'female'])
var(resid(fit)[df2$sex == 'female'])/var(resid(fit)[df2$sex == 'male'])
getcwd()
cwd()
wd()
setwd("C:/Users/Mikkel/Google Drive/Mathematical modelling and computation/2. semester/02424 - Advanced dataanalysis/Week 7")
read.table('Snails.txt')
read.table('Snails.txt', head = True)
read.table('Snails.txt',header = T)
dat = read.table('Snails.txt',header = T)
dat$p = dat$deaths/dat$n
dat
plot(dat$p ~ day$humidity, col = dat$species)
plot(dat$p ~ dat$humidity, col = dat$species)
plot(dat$p ~ dat$humidity, col = as.factor(dat$species))
plot(dat$p ~ dat$humidity, col = as.factor(dat$species), pch = as.factor(dat$species))
plot(dat$p ~ dat$humidity, col = as.factor(dat$species))
plot(dat$p ~ dat$temp, col = as.factor(dat$species))
plot(dat$p ~ dat$exposure, col = as.factor(dat$species))
col <- numeric(dim(snails)[1])
snails = read.table('Snails.txt',header = T)
snails$p = snails$deaths/snails$n
col <- numeric(dim(snails)[1])
col
pch
pch <- numeric(dim(snails)[1])
col[snails$species=="A"] <- 1
col[snails$species=="B"] <- 2
pch[snails$exposure==1] <- 1
pch[snails$exposure==2] <- 2
pch[snails$exposure==3] <- 3
pch[snails$exposure==4] <- 4
scatterplot3d(snails[ ,c("humidity","temp","p")],color=col,pch=pch)
library(scatterplot3d)
install.packages("scatterplot3d")
library(scatterplot3d)
scatterplot3d(snails[ ,c("humidity","temp","p")],color=col,pch=pch)
plot(snails$p ~ snails$humidity, col = as.factor(snails$species))
plot(snails$p ~ snails$temp, col = as.factor(snails$species))
plot(snails$p ~ snails$exposure, col = as.factor(snails$species))
par(mfrow(3,1))
plot(snails$p ~ snails$humidity, col = as.factor(snails$species))
plot(snails$p ~ snails$temp, col = as.factor(snails$species))
plot(snails$p ~ snails$exposure, col = as.factor(snails$species))
par(mfrow=c(3,1))
plot(snails$p ~ snails$humidity, col = as.factor(snails$species))
plot(snails$p ~ snails$temp, col = as.factor(snails$species))
plot(snails$p ~ snails$exposure, col = as.factor(snails$species))
snails$resp = cbind(snails$death, snails$n-snails$death)
snails
glm(resp ~ factor(humidity)*factor(temp)*factor(exposure), data = snails)
glm(resp ~ factor(humidity)*factor(temp)*factor(exposure)*species, data = snails)
glm(resp ~ factor(humidity)*factor(temp)*factor(exposure)*species, data = snails, family = binomial)
fit1 = glm(resp ~ factor(humidity)*factor(temp)*factor(exposure)*species, data = snails, family = binomial)
summary(fit1)
fit2 = glm(resp ~ (humidity)*(temp)*(exposure)*species, data = snails, family = binomial)
summary(fit2)
anova(fit1,fit2, test = 'chisq')
anova(fit1,fit2, test = 'Chisq')
fit2 = glm(resp ~ factor(humidity)*factor(temp)*factor(exposure)*species, data = snails, family = binomial)
summary(fit1)
fit2 <- update(fit1,.~.-factor(humidity):factor(temp):factor(exposure):species)
fit1 = glm(resp ~ factor(humidity)*factor(temp)*factor(exposure)*species, data = snails, family = binomial)
summary(fit1)
fit2 <- update(fit1,.~.-factor(humidity):factor(temp):factor(exposure):species)
fit2
summary(fit2)
?update
anova(fit1,fit2, test = 'Chisq')
summary(fit1)
fit2 <- update(fit1,.~.-factor(humidity):factor(temp):factor(exposure):species)
summary(fit2)
fit3 <- update(fit2,.~. - factor(humidity):factor(temp):species - factor(humidity):factor(temp):factor(exposure)
-  factor(humidity):factor(exposure):species-
factor(temp):factor(exposure):species)
summary(fit3)
fit4 <- update(fit3,.~.-factor(humidity):factor(exposure)- factor(humidity):factor(temp) -
factor(humidity):species)
summary(fit4)
fit5 <- update(fit4,.~.-factor(temp):species-factor(exposure):species )
summary(fit5)
fit6 <- update(fit5,.~.-factor(temp):factor(exposure))
summary(fit6)
fit7 <- glm(formula = resp ~ humidity + factor(temp) + factor(exposure) +
species, family = binomial, data = snails)
summary(fit7)
fit8 <- glm(formula = resp ~ humidity + temp + factor(exposure) +
species, family = binomial, data = snails)
summary(fit8)
anova(fit7,test="Chisq")
anova(fit8,test="Chisq")
plot(fit7)
par(mfrow= c(2,2))
plot(fit7)
anova(fit1,fit0,test="Chisq")
anova(fit2,fit1,test="Chisq")
anova(fit5,fit1,test="Chisq")
anova(fit6,fit1,test="Chisq")
anova(fit7,fit1,test="Chisq")
anova(fit8,fit7,test="Chisq")
anova(fit3,test="Chisq")
drop1(fit3,test="Chisq")
drop1(fit4,test="Chisq")
drop1(fit5,test="Chisq")
drop1(fit3,test="Chisq")
drop1(fit4,test="Chisq")
drop1(fit3,test="Chisq")
anova(fit2, test = 'Chisq')
drop1(fit2, test = 'Chisq')
fit2 <- update(fit1,.~.-factor(humidity):factor(temp):factor(exposure):species)
drop1(fit2, test = 'Chisq')
anova(fit2, test = 'Chisq')
summary(fit2)
drop1(fit2, test = 'Chisq')
drop1(fit1, test = 'Chisq')
anova(fit1, test = 'Chisq')
step(fit1)
fit2 <- update(fit1,.~.-factor(humidity):factor(temp):factor(exposure):species)
drop1(fit2, test = 'Chisq')
fit3 <- update(fit2,.~. - factor(humidity):factor(temp):species - factor(humidity):factor(temp):factor(exposure)
-  factor(humidity):factor(exposure):species-
factor(temp):factor(exposure):species)
drop1(fit3, test = 'Chisq')
fit4 <- update(fit3,.~.-factor(humidity):factor(exposure)- factor(humidity):factor(temp) -
factor(humidity):species- factor(temp):species-factor(exposure):species -factor(temp):factor(exposure))
drop1(fit4, test = 'Chisq')
fit1 = glm(resp ~ factor(humidity)*factor(temp)*factor(exposure)*species, data = snails, family = binomial)
drop1(fit1, test = 'Chisq')
anova(fit1, test = 'Chisq')
#Remove 4th order interaction
drop1(fit1, test = 'Chisq')
drop1(fit2, test = 'Chisq')
fit3 <- update(fit2,.~. - factor(humidity):factor(temp):species - factor(humidity):factor(temp):factor(exposure)
-  factor(humidity):factor(exposure):species-
factor(temp):factor(exposure):species)
drop1(fit3, test = 'Chisq')
fit4 <- update(fit3,.~.-factor(humidity):factor(exposure)- factor(humidity):factor(temp) -
factor(humidity):species- factor(temp):species-factor(exposure):species -factor(temp):factor(exposure))
drop1(fit4, test = 'Chisq')
anova(fit4, test = 'Chisq')
summary(fit4)
pchisq(30.807, 86,lower.tail = T)
pchisq(30.807, 86,lower.tail = F)
1-pchisq(30.807, 86)
1-pchisq(30.807, 86, lower.tail = T)
1-pchisq(30.807, 86, lower.tail = F)
#Without factor:
fit1 = glm(resp ~ (humidity)*(temp)*(exposure)*species, data = snails, family = binomial)
drop1(fit1, test = 'Chisq')
fit4 <- update(fit3,.~.-factor(humidity):factor(exposure)- factor(humidity):factor(temp) -
factor(humidity):species- factor(temp):species-factor(exposure):species -factor(temp):factor(exposure))
drop1(fit4, test = 'Chisq')
#Without factor:
fit1 = glm(resp ~ (humidity)*(temp)*(exposure)*species, data = snails, family = binomial)
drop1(fit1, test = 'Chisq')
fit2 <- update(fit1,.~.-(humidity):(temp):(exposure):species)
drop1(fit2, test = 'Chisq')
fit3 <- update(fit2,.~. - factor(humidity):factor(temp):species - factor(humidity):factor(temp):factor(exposure)
-  factor(humidity):factor(exposure):species-
factor(temp):factor(exposure):species)
drop1(fit3, test = 'Chisq')
fit3 <- update(fit2,.~. - factor(humidity):factor(temp):species - factor(humidity):factor(temp):factor(exposure)
-  factor(humidity):factor(exposure):species-
factor(temp):factor(exposure):species)
drop1(fit3, test = 'Chisq')
#Without factor:
fitf1 = glm(resp ~ (humidity)+(temp)+(exposure)+species, data = snails, family = binomial)
drop1(fitf1, test='Chisq)'
drop1(fitf1, test='Chisq')
drop1(fitf1, test='Chisq')
fit1 = glm(resp ~ factor(humidity)*factor(temp)*factor(exposure)*species, data = snails, family = binomial)
drop1(fit1, test = 'Chisq')
anova(fit1, test = 'Chisq')
#Remove 4th order interaction
fit2 <- update(fit1,.~.-factor(humidity):factor(temp):factor(exposure):species)
drop1(fit2, test = 'Chisq')
#Remove all third-order interactions:
fit3 <- update(fit2,.~. - factor(humidity):factor(temp):species - factor(humidity):factor(temp):factor(exposure)
-  factor(humidity):factor(exposure):species-
factor(temp):factor(exposure):species)
drop1(fit3, test = 'Chisq')
#Remove all second order interactions
fit4 <- update(fit3,.~.-factor(humidity):factor(exposure)- factor(humidity):factor(temp) -
factor(humidity):species- factor(temp):species-factor(exposure):species -factor(temp):factor(exposure))
drop1(fit4, test = 'Chisq')
anova(fit4, test = 'Chisq')
summary(fit4)
1-pchisq(30.807, 86, lower.tail = T)
#Residuals not following Chisq dist
fitf1 = glm(resp ~ (humidity)+(temp)+(exposure)+species, data = snails, family = binomial)
drop1(fitf1, test='Chisq')
anova(fit4, fitf1, test = 'Chisq')
summary(fitf1)
1-pchisq(55.07, 91, lower.tail = T)
1-pchisq(30.807, 86, lower.tail = T)
1-pchisq(55.07, 91, lower.tail = T)
anova(fit4, fitf1, test = 'Chisq')
1-pchisq(55.07, 91)
1-pchisq(30.807, 86)
c(AIC(fit4), AIC(fitf1))
par(mfrow=c(2,2))
plot(fit4)
par(mfrow=c(2,2))
plot(fitf1)
par(mfrow=c(2,2))
plot(fit4)
par(mfrow=c(2,2))
plot(fitf1)
View(snails)
fitf1 = glm(resp ~ (humidity)+(temp)+factor(exposure)+species, data = snails, family = binomial)
fitf2 = glm(resp ~ (humidity)+(temp)+factor(exposure)+species, data = snails, family = binomial)
drop1(fitf2, test='Chisq')
#Without factor:
fitf1 = glm(resp ~ (humidity)+(temp)+(exposure)+species, data = snails, family = binomial)
plot(fitf2)
anova(fit4, fitf1,fitf2, test = 'Chisq')
c(AIC(fit4), AIC(fitf1), AIC(fitf2))
#Change link function:
fitf2 = glm(resp ~ (humidity)+(temp)+factor(exposure)+species, data = snails, family = binomial(link = 'cloglog'))
fitf2 = glm(resp ~ (humidity)+(temp)+factor(exposure)+species, data = snails, family = binomial)
#Change link function:
fitf3 = glm(resp ~ (humidity)+(temp)+factor(exposure)+species, data = snails, family = binomial(link = 'cloglog'))
drop1(fitf3, test = 'Chisq')
AIC(fitf3)
#Change link function:
fitf3 = glm(resp ~ (humidity)+(temp)+factor(exposure)+species, data = snails, family = binomial(link = 'probit'))
drop1(fitf3, test = 'Chisq')
AIC(fitf3)
#Change link function:
fitf3 = glm(resp ~ (humidity)+(temp)+factor(exposure)+species, data = snails, family = binomial(link = 'log'))
drop1(fitf3, test = 'Chisq')
AIC(fitf3)
#Change link function:
fitf3 = glm(resp ~ (humidity)+(temp)+factor(exposure)+species, data = snails, family = binomial(link = 'cauchit'))
drop1(fitf3, test = 'Chisq')
AIC(fitf3)
fitf3 = glm(resp ~ ((humidity)+(temp)+factor(exposure))*species, data = snails, family = binomial)
drop1(fitf3, test='Chisq')
fitf4 = glm(resp ~ ((humidity)+(temp))*species+ factor(exposure), data = snails, family = binomial)
drop1(fitf4, test='Chisq')
fitf5 = glm(resp ~ humidity*species+ factor(exposure)+(temp), data = snails, family = binomial)
drop1(fitf5, test='Chisq')
fitf5 = glm(resp ~ factor(humidity)+species+ factor(exposure)+(temp), data = snails, family = binomial)
drop1(fitf5, test='Chisq')
AIC(fitf5)
plot(fitf5)
snails <- read.table("snails.txt",header=TRUE)
head(snails)
snails$p <- snails$death/snails$n
library(scatterplot3d)
col <- numeric(dim(snails)[1])
pch <- numeric(dim(snails)[1])
col[snails$species=="A"] <- 1
col[snails$species=="B"] <- 2
pch[snails$exposure==1] <- 1
pch[snails$exposure==2] <- 2
pch[snails$exposure==3] <- 3
pch[snails$exposure==4] <- 4
scatterplot3d(snails[ ,c("humidity","temp","p")],color=col,pch=pch)
scatterplot3d(snails[ ,c("humidity","temp","p")],color=col,pch=pch)
plot(p~humidity,color=col,pch=pch,data=snails)
plot(p~humidity,col=col,pch=pch,data=snails)
plot(p~temp,col=col,pch=pch,data=snails)
plot(p~exposure,col=col,pch=pch,data=snails)
snails$resp <- cbind(snails$death,snails$n-snails$death)
fit0 <- glm(resp~factor(humidity)*factor(temp)*factor(exposure)*species,data=snails,family=binomial)
fit1 <- update(fit0,.~.-factor(humidity):factor(temp):factor(exposure):species)
fit2 <- update(fit1,.~.-factor(humidity):factor(temp):factor(exposure)-
factor(humidity):factor(temp):species-
factor(humidity):factor(exposure):species-
factor(temp):factor(exposure):species)
fit3 <- update(fit2,.~.-factor(humidity):factor(exposure)- factor(humidity):factor(temp) -
factor(humidity):species)
fit4 <- update(fit3,.~.-factor(temp):species-factor(exposure):species )
fit5 <- update(fit4,.~.-factor(temp):factor(exposure))
fit6 <- glm(formula = resp ~ humidity + factor(temp) + factor(exposure) +
species, family = binomial, data = snails)
fit7 <- glm(formula = resp ~ humidity + temp + factor(exposure) +
species, family = binomial, data = snails)
anova(fit7,test="Chisq")
summary(fit1)
summary(fit2)
summary(fit3)
summary(fit4)
summary(fit5)
summary(fit7)
plot(fit7)
anova(fit1,fit0,test="Chisq")
anova(fit4,fit0,test="Chisq")
anova(fit5,fit0,test="Chisq")
anova(fit6,fit0,test="Chisq")
anova(fit7,fit6,test="Chisq")
anova(fit7,fit0,test="Chisq")
glm(resp~factor(humidity),family=binomial,data=snails)
glm(resp~factor(humidity)+factor(temp)+factor(exposure)+species, family=binomial,data=snails)
glm(resp~factor(humidity),family=binomial,data=snails)
fit8 <- glm(formula = resp ~ humidity + temp + factor(exposure) +
species, family = binomial, data = snails[snails$exposure!=1, ])
fit8
fit9 <- glm(formula = resp ~ humidity + temp + I(exposure-1) + I((exposure-1)^2) +
species, family = binomial, data = snails)
summary(fit8)
summary(fit9)
anova(fit9,fit7,test="Chisq")
4.10485*1-0.70029*1^2
4.10485*2-0.70029*2^2
4.10485*3-0.70029*3^2
fit10 <- glm(formula = resp ~ humidity+ temp  + species+ I(exposure-1) + I((exposure-1)^2),
family = binomial, data = snails)
summary(fit10)
drop1(fit10,test="Chisq")
anova(fit10,fit9,test="Chisq")
hum <- seq(40,90,by=1)
temp <- seq(5,30,by=1)
pred1 <- predict(fit10, newdata = data.frame(humidity=hum[1], temp=temp,
species = "B", exposure = 4))
s3d <- scatterplot3d(cbind(hum[1],temp,pred1),type="l",color=gray(0.5),
xlim=c(40,90),ylim=c(5,30),zlim=c(-3.5,4.5))
for(i in 2:length(hum)){
pred1 <- predict(fit10, newdata = data.frame(humidity=hum[i],
temp=temp, species = "B", exposure = 4))
s3d$points3d(cbind(hum[i],temp,pred1),
pch=19,type="l",col=gray(0.5))
}
for(i in 1:length(temp)){
pred1 <- predict(fit10, newdata = data.frame(humidity=hum,
temp=temp[i], species = "B", exposure = 4))
s3d$points3d(cbind(hum,temp[i],pred1),
pch=19,type="l",col=gray(0.5))
}
pred1 <- predict(fit10, newdata = data.frame(humidity=hum[1], temp=temp,
species = "B", exposure = 4),
type="response")
s3d <- scatterplot3d(cbind(hum[1],temp,pred1),type="l",color=gray(0.5),
xlim=c(40,90),ylim=c(5,30),zlim=c(0,1))
I <- snails$species=="B" & snails$exposure==4
s3d$points3d(snails$humidity[I],snails$temp[I],snails$p[I],
pch=19,type="p",col=2)
for(i in 2:length(hum)){
pred1 <- predict(fit10, newdata = data.frame(humidity=hum[i],
temp=temp, species = "B", exposure = 4),
type="response")
s3d$points3d(cbind(hum[i],temp,pred1),
pch=19,type="l",col=gray(0.5))
}
for(i in 1:length(temp)){
pred1 <- predict(fit10, newdata = data.frame(humidity=hum,
temp=temp[i], species = "B", exposure = 4),
type="response")
s3d$points3d(cbind(hum,temp[i],pred1),
pch=19,type="l",col=gray(0.5))
}
fit11 <- glm(formula = resp ~ exposure + I(exposure*exposure) +
humidity+ temp  + species,
family = binomial(link=logit), data = snails)
summary(fit11)
summary(fit10)
fitf5 = glm(resp ~ factor(humidity)+species+ factor(exposure)+(temp), data = snails, family = binomial)
drop1(fitf5, test='Chisq')
AIC(fitf5)
c(AIC(fit4), AIC(fitf1), AIC(fitf2))
str(snails)
exposure^2
snails$exposure^2
fit12 <- glm(formula = resp ~ exposure + I(exposure^2) +
humidity+ temp  + species,
family = binomial(link=logit), data = snails)
summary(fit12)
anova(fit11, fit12, test = 'Chisq')
fit10
anova(fit10, fit11, test = 'Chisq')
c(AIC(fit10), AIC(fit11))
glm(resp~factor(humidity)+factor(temp)+factor(exposure)+species, family=binomial,data=snails)
glm(resp~factor(humidity),family=binomial,data=snails)
fit10 <- glm(formula = resp ~ humidity+ temp  + species+ I(exposure-1) + I((exposure-1)^2),
family = binomial, data = snails)
summary(fit10)
fit9 <- glm(formula = resp ~ humidity + temp + I(exposure-1) + I((exposure-1)^2) +
species, family = binomial, data = snails[snails$exposure!=1, ])
summary(fit9)
fit9 <- glm(formula = resp ~ humidity + temp + I(exposure) + I((exposure)^2) +
species, family = binomial, data = snails[snails$exposure!=1, ])
summary(fit9)
fit9
fit9 <- glm(formula = resp ~ humidity + temp + I(exposure-1) + I((exposure-1)^2) +
species, family = binomial, data = snails[snails$exposure!=1, ])
fit9
summary(fit9)
fit9 <- glm(formula = resp ~ -1 + humidity + temp + I(exposure-1) + I((exposure-1)^2) +
species, family = binomial, data = snails[snails$exposure!=1, ])
summary(fit9)
fit9 <- glm(formula = resp ~ -1 + humidity + temp + I(exposure-1) + I((exposure-1)^2) +
factor(species), family = binomial, data = snails[snails$exposure!=1, ])
summary(fit9)
fit9 <- glm(formula = resp ~ -1 + humidity + temp + I(exposure-1) + I((exposure-1)^2) +
factor(species), family = binomial, data = snails[snails$exposure!=1, ])
fit9 <- glm(formula = resp ~ humidity + temp + I(exposure-1) + I((exposure-1)^2) +
factor(species), family = binomial, data = snails[snails$exposure!=1, ])
summary(fit9)
fit9 <- glm(formula = resp ~ humidity + temp + I(exposure-1) + I((exposure-1)^2) +
species, family = binomial, data = snails[snails$exposure!=1, ])
fit91 <- glm(formula = resp ~ humidity + temp + I(exposure-1) + I((exposure-1)^2) +
factor(species), family = binomial, data = snails[snails$exposure!=1, ])
anova(fit9,fit91,test="Chisq")
fit91 <- glm(formula = resp ~ humidity + temp + I(exposure) + I((exposure)^2) +
factor(species), family = binomial, data = snails[snails$exposure!=1, ])
anova(fit9,fit91,test="Chisq")
step(fit1)
snails <- read.table("snails.txt",header=TRUE)
head(snails)
snails$p <- snails$death/snails$n
library(scatterplot3d)
col <- numeric(dim(snails)[1])
pch <- numeric(dim(snails)[1])
col[snails$species=="A"] <- 1
col[snails$species=="B"] <- 2
setwd("C:/Users/Mikkel/Google Drive/Mathematical modelling and computation/2. semester/02424 - Advanced dataanalysis/Week 7")
snails <- read.table("snails.txt",header=TRUE)
head(snails)
snails$p <- snails$death/snails$n
library(scatterplot3d)
col <- numeric(dim(snails)[1])
pch <- numeric(dim(snails)[1])
col[snails$species=="A"] <- 1
col[snails$species=="B"] <- 2
pch[snails$exposure==1] <- 1
pch[snails$exposure==2] <- 2
pch[snails$exposure==3] <- 3
pch[snails$exposure==4] <- 4
scatterplot3d(snails[ ,c("humidity","temp","p")],color=col,pch=pch)
plot(p~humidity,color=col,pch=pch,data=snails)
plot(p~humidity,col=col,pch=pch,data=snails)
plot(p~temp,col=col,pch=pch,data=snails)
plot(p~exposure,col=col,pch=pch,data=snails)
snails$resp <- cbind(snails$death,snails$n-snails$death)
fit0 <- glm(resp~factor(humidity)*factor(temp)*factor(exposure)*species,data=snails,family=binomial)
step(fit0)
fit0 <- glm(resp~factor(humidity)*factor(temp)*factor(exposure)*species,data=snails,family=binomial)
step(fit0)
fit0 <- glm(resp~(humidity)*(temp)*(exposure)*species,data=snails,family=binomial)
step(fit0)
fit0 <- glm(resp~(humidity)*(temp)*factor(exposure)*species,data=snails,family=binomial)
step(fit0)
fit0 <- glm(resp~(humidity)*factor(temp)*(exposure)*species,data=snails,family=binomial)
step(fit0)
fit0 <- glm(resp~factor(humidity)*(temp)*(exposure)*species,data=snails,family=binomial)
step(fit0)
?step
setwd("C:/Users/Mikkel/Google Drive/Mathematical modelling and computation/2. semester/02424 - Advanced dataanalysis/Week 6")
lsdir()
read.table('challenger.txt')
read.table('challenger_data.txt')
read.table('challenger_data.txt', header =T )
d = read.table('challenger_data.txt', header =T )
plot(d$temp, d$failed)
par(mfrow= c(2,1))
plot(d$temp, d$failed)
plot(d$pres, d$failed)
d$resp = cbind(d$failed, d$n - d$failed)
d$resp = cbind(d$failed, d$number - d$failed)
glm(resp ~ temp*pres*)
d
d$resp = cbind(d$failed, d$n - d$failed)
glm(resp ~ temp, data = d, family = binomial(link = "logit"))
fit1 = glm(resp ~ temp, data = d, family = binomial(link = "logit"))
anova(fit1, test = 'Chisq')
drop1(fit1, test = 'Chisq')
fit2 = glm(resp ~ pres, data = d, family = binomial(link = "logit"))
anova(fit1, test = 'Chisq')
anova(fit2, test = 'Chisq')
fit3 = glm(resp ~ temp + pres, data = d, family = binomial(link = "logit"))
anova(fit3, test = 'Chisq')
#Predict using following temperatures:
temp <- seq(31,85)
predict(fit1, newdata = data.frame(temp = temp), type = 'response')
pred = predict(fit1, newdata = data.frame(temp = temp), type = 'response')
plot(temp, pred)
plot(d$temp,d$failed)
plot(d$temp,d$failed, col = 'red')
plot(d$temp,d$failed, col = 'red')
points(temp, pred, col = 'blue')
plot(d$temp,d$failed, col = 'red', xlim = c(31, 90))
points(temp, pred, col = 'blue')
#Odds for decrease of 10 in temp:
#exp(-10*coef(fit1)[2])
coef(fit1)
#Odds for decrease of 10 in temp:
#exp(-10*coef(fit1)[2])
exp(coef(fit1)[2]*(-10))
